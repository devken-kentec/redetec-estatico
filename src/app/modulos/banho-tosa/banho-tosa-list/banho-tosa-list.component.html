<div class="col-md-12" style="margin-top: 50px;">
  <nav>
    <ol class="breadcrumb bg-white">
      <li class="breadcrumb-item"><a routerLink="/">Início</a></li>
      <li class="breadcrumb-item active">Listagem</li>
    </ol>
  </nav>
  <div class="row mb-4">
    <div class="col-md">
      <h1 class="h5 border-left pl-2">
        Listagem de Banhos e Tosas
      </h1>
    </div>
    <div class="col-md">
      <button routerLink="new" class="btn btn-primary float-right">
        <i class="fas fa-user-plus"></i> Cadastrar Banhos
      </button>
    </div>
  </div>
    <div>
      <button class="btn btn-primary" type="button" (click)="mostrarFiltroData()">
        Filtrar Banhos
      </button>
    </div>
    @if(mostrarFiltro){
      <div class="card mt-3">
        <form class="needs-validation" novalidate [formGroup]="banhoTosaForm">
          <div class="card-body">
            <nav class="col-md-12">
              <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Animal e Status Pagamento</a>
                <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Data</a>
                <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">Status Pagamento</a>
                <a class="nav-item nav-link" id="nav-finali-tab" data-toggle="tab" href="#nav-finali" role="tab" aria-controls="nav-finali" aria-selected="false">Inativos</a>
              </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
              <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                <div class="form-row col-md-12 mt-3 ml-3 d-flex justify-content-center">
                  <div class="form-group col-md-4">
                    <label for="animal">Animal/Humano:</label>
                    <select id="animal" class="form-control" formControlName="animal">
                      <option value="">Selecione</option>
                      @for( select of selectAnimal; track select.id){
                        <option [value]="select.id">{{ select.nome }} - {{ select.humano.nome }} {{ select.humano.sobrenome }}</option>
                      }
                    </select>
                  </div>
                  <div class="form-group col-md-2">
                    <label for="statusPagamentoBanho">Status Pagamento:</label>
                    <select id="statusPagamentoBanho" class="form-control" formControlName="statusPagamentoBanho">
                      <option value="">Selecione</option>
                      <option>Em aberto</option>
                      <option>Pago</option>
                    </select>
                  </div>
                  <div class="col-12 d-flex justify-content-center">
                    <button class="btn btn-info col-6" type="button" (click)="filtrarBanhoAnimalStatusPagamentoPage(this.pagina, this.paginaForm.get('quantPag')?.value)">
                      Filtrar Banho
                    </button>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                <div class="form-row col-md-12 mt-3 ml-3 d-flex justify-content-center">
                  <div class="form-group col-md-4">
                    <label for="inicio">Data:</label>
                    <input
                      type="date"
                      id="inicio"
                      class="form-control"
                      formControlName="inicio"/>
                  </div>
                </div>
                <div class="col-12 d-flex justify-content-center">
                  <button class="btn btn-info col-6" type="button" (click)="filtrarBanhoDataPage(this.pagina, this.paginaForm.get('quantPag')?.value)">
                    Filtrar Banho
                  </button>
                </div>
              </div>
              <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
                <div class="form-row col-md-12 mt-3 ml-3 d-flex justify-content-center">
                  <div class="form-group col-md-4">
                    <label for="statusPagamentoBanho">Status Pagamento:</label>
                    <select id="statusPagamentoBanho" class="form-control" formControlName="statusPagamentoBanho">
                      <option value="">Selecione</option>
                      <option>Em aberto</option>
                      <option>Pago</option>
                    </select>
                  </div>
                </div>
                <div class="col-12 d-flex justify-content-center">
                  <button class="btn btn-info col-6" type="button" (click)="filtrarBanhoStatusPagamentoPage(this.pagina, this.paginaForm.get('quantPag')?.value)">
                    Filtrar Banho
                  </button>
                </div>
              </div>
              <div class="tab-pane fade" id="nav-finali" role="tabpanel" aria-labelledby="nav-finali-tab">
                <div class="form-row col-md-12 mt-3 ml-3 d-flex justify-content-center">
                  <div class="form-group col-md-4">
                    <label for="status">Status:</label>
                    <select id="status" class="form-control" formControlName="status">
                      <option value="">Selecione</option>
                      <option>Inativo</option>
                    </select>
                  </div>
                </div>
                <div class="col-12 d-flex justify-content-center">
                  <button class="btn btn-info col-6" type="button" (click)="filtrarBanhoStatusInativoPage(this.pagina, this.paginaForm.get('quantPag')?.value)">
                    Filtrar Banho
                  </button>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    }
    @defer (when carregando){
      <div id="table" class="table-responsive mt-3">
        <table class="table table-borderless">
          <thead>
            <tr class="bg-dark text-light">
              <th>ID</th>
              <th>Animal</th>
              <th>Humano</th>
              <th>Início</th>
              <th>Status Banho</th>
              <th>Status Pag.</th>
              <th>Status</th>
              <th>Total</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            @for(lista of listaBanhoTosa; track lista.id; let i = $index){
            <tr>
              <td>{{ lista.id }}</td>
              <td>{{ lista.animalNome }}</td>
              <td>{{ lista.animalHumano }}</td>
              <td>{{ sharedService.formatDate(lista.inicio) }} - {{ sharedService.formatTime(lista.inicio) }}</td>
              <td>{{ lista.statusBanhoTosa }}</td>
              <td>{{ lista.statusPagamentoBanho }}</td>
              <td>{{ lista.status }}</td>
              @if(lista.statusPagamentoBanho === 'Pago'){
                <td>{{ calcularValorTotalBanho(lista.tipoBanhoValor, lista.transporte, lista.desconto).toLocaleString('pt-br',{style: 'currency', currency: 'BRL'})}}</td>
              } @else {
                <td>R$ 0,00</td>
              }
              <td>
                <button (click)="editar(lista.id)" class="btn btn-outline-info btn-sm"><i class="far fa-edit"></i></button>
                @if(lista.id > 0){
                  <button (click)="recuperarDados(lista)" class="btn btn-outline-danger btn-sm" data-toggle="modal" data-target="#staticBackdrop"><i class="fas fa-user-slash"></i></button>
                }
                <button (click)="fecharPagamento(lista.id)" class="btn btn-outline-success btn-sm"><i class="fas fa-money-bill-alt"></i></button>
                <a [href]="vincularWhatsApp(lista.zap, lista.animalNome)" type="button" target="_blank" class="btn btn-outline-success btn-sm"><i class="fab fa-whatsapp"></i></a>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
      <div class="float-right mt-1" style="font-weight: bold"><span style="color: blue;">Valor Total Dia:</span>{{ valorTotalBanhoDia?.toLocaleString('pt-br',{style: 'currency', currency: 'BRL'}) }}</div>
    } @placeholder {
      <div class="d-flex justify-content-center">
        <div class="spinner-border text-primary mt-4" role="status">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
    } @loading {
      <p>Carregando a Lista de Banhos...</p>
    }
  @if(mostrarPaginacao){
    <form class="needs-validation" novalidate [formGroup]="paginaForm" style="margin-top: 15px;">
      <div class="row col-12 d-flex justify-content-center align-items-center" style="font-size: 10pt;">
          <button type="button" data-toggle="tooltip" data-placement="top" title="Menor" class="btn btn-info" (click)="paginaMenor()">
              <i class="fas fa-minus"></i> Anterior
          </button>
          <div class="form-group" style="margin-top: 15px; text-align: center; width: 120px;"><span>Pág. {{ pagina + 1}}  de {{ totalPages  }}</span></div>
          <button type="button" data-toggle="tooltip" data-placement="top" title="Maior" class="btn btn-info" (click)="paginaMaior()">
            <i class="fas fa-plus"></i> Próximo
          </button>
          <div class="form-group ml-1" style="margin-top: 15px; text-align: center; width: 65px;">
            <select class="form-control" id="pegaTamanho" name="quantPag" formControlName="quantPag" (change)="atualizaPagina()">
                <option value=5>5</option>
                <option value=10>10</option>
                <option value=25>25</option>
                <option value=50>50</option>
            </select>
          </div>
        <span class="float-right ml-1">Total de registro: {{ totalElements }}</span>
    </div>
  </form>
  }

    @if(banhoTosa){
      <div>
        <app-modal-form [entrada]="banhoTosa" (emitirEvento)="excluirRegistro($event)"/>
      </div>
    }
</div>
